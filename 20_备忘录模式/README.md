# 20 - 备忘录模式 (Memento Pattern)

> **核心思想**: 在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可将该对象恢复到原先保存的状态。

## 📚 概念解析

备忘录模式（Memento Pattern）是一种行为设计模式，它允许在不暴露对象实现细节的情况下，保存和恢复对象之前的状态。这种模式在需要实现撤销/重做功能时特别有用。

**主要角色**:
- **发起人 (Originator)**: 拥有需要被保存状态的原始对象。它创建一个备忘录，并使用它来恢复自己的内部状态。
- **备忘录 (Memento)**: 一个用于存储发起人内部状态的值对象。备忘录应该对除发起人之外的其他对象隐藏其实现细节。
- **管理者 (Caretaker)**: 负责保存备忘录，但不能操作或检查备忘录的内容。

## 📂 代码示例

| 文件名                        | 描述                                                           |
| ----------------------------- | -------------------------------------------------------------- |
| `01_basic_memento.py`       | 一个基础的文本编辑器，演示了如何使用备忘录模式实现撤销和重做功能。 |
| `02_document_editor.py`     | 一个更复杂的文档编辑器，支持对格式和内容的撤销。               |
| `03_game_save_system.py`    | 一个游戏存档系统，演示了如何保存和加载复杂的游戏状态。           |
| `04_database_transaction.py`| 模拟数据库事务，使用备忘录模式来实现事务的回滚。               |
| `05_configuration_manager.py`| 一个配置管理器，允许用户修改配置并可以恢复到之前的任何版本。     |
| `06_real_world_examples.py`   | 真实世界的应用，如图形编辑器的操作历史、工作流的状态管理等。   |

## ✅ 优点

- **封装性**: 可以在不破坏发起人封装性的前提下，保存其状态。
- **简化发起人**: 发起人不需要管理其状态历史，将这部分责任转移给了管理者。
- **提供了状态恢复机制**: 可以方便地将对象恢复到之前的状态。

## ❌ 缺点

- **资源消耗**: 如果发起人的状态非常大，或者历史记录很长，可能会消耗大量的内存。
- **可能破坏封装**: 如果备忘录暴露了过多的发起人内部状态，可能会破坏封装。

## 🚀 如何运行

```bash
# 运行基础示例
python 20_备忘录模式/01_basic_memento.py

# 运行文档编辑器示例
python 20_备忘录模式/02_document_editor.py

# 运行游戏存档系统示例
python 20_备忘录模式/03_game_save_system.py

# 运行数据库事务示例
python 20_备忘录模式/04_database_transaction.py

# 运行配置管理器示例
python 20_备忘录模式/05_configuration_manager.py

# 运行实际应用示例
python 20_备忘录模式/06_real_world_examples.py
```
