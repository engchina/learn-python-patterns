# 13 - 享元模式 (Flyweight Pattern)

> **核心思想**: 运用共享技术来有效地支持大量细粒度的对象，以减少内存占用和提高性能。

## 📚 概念解析

享元模式（Flyweight Pattern）是一种结构型设计模式，它旨在通过共享尽可能多的相似对象来最小化内存使用。当程序需要生成大量对象，并且这些对象具有许多相同的状态时，此模式非常有用。

**状态分离**:
享元模式的关键在于将对象的状态分为两部分：
- **内在状态 (Intrinsic State)**: 存储在享元对象内部，并且是不可变的。它可以被多个上下文共享。例如，一个字符的字形。
- **外在状态 (Extrinsic State)**: 由客户端代码计算或存储，并且在每次调用享元对象的方法时传递给它。它特定于每个上下文。例如，一个字符在文档中的位置和颜色。

**主要角色**:
- **享元 (Flyweight)**: 声明了享元对象的接口。
- **具体享元 (Concrete Flyweight)**: 实现了享元接口，并为内在状态添加存储空间。
- **享元工厂 (Flyweight Factory)**: 创建并管理享元对象，确保它们被正确地共享。

## 📂 代码示例

| 文件名                     | 描述                                                           |
| -------------------------- | -------------------------------------------------------------- |
| `01_basic_flyweight.py`    | 一个基础示例，演示了享元模式的核心思想和基本结构。             |
| `02_text_editor.py`        | 一个文本编辑器，其中每个字符的字形（内在状态）被共享，而其位置和格式（外在状态）是唯一的。 |
| `03_game_particles.py`     | 一个游戏粒子系统，其中粒子的类型（如纹理、颜色）是共享的，而其位置、速度是唯一的。 |
| `04_web_elements.py`       | 一个网页渲染系统，其中相似的HTML元素（如按钮样式）被共享。       |
| `05_real_world_examples.py`| 真实世界的应用，如图标缓存、数据库连接池等。                   |

## ✅ 优点

- **显著减少内存占用**: 如果程序中有大量相似的对象，可以节省大量内存。
- **提高性能**: 减少了需要初始化的对象数量。

## ❌ 缺点

- **增加了代码的复杂性**: 需要将对象的状态分为内在和外在，这可能会使代码更难理解。
- **牺牲了运行时间来换取空间**: 可能需要更多时间来计算外在状态。

## 🚀 如何运行

```bash
# 运行基础示例
python 13_享元模式/01_basic_flyweight.py

# 运行文本编辑器示例
python 13_享元模式/02_text_editor.py

# 运行游戏粒子示例
python 13_享元模式/03_game_particles.py

# 运行网页元素示例
python 13_享元模式/04_web_elements.py

# 运行实际应用示例
python 13_享元模式/05_real_world_examples.py
```
